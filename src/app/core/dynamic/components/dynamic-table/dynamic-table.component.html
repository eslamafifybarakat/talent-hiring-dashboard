<div id="dynamic-global-data-table">
  <div class="table-content">
    <!-- [rowsPerPageOptions]="rowsPerPageOptions"  -->
    <p-table #dt1 [value]="tableData" (onFilter)="customFilter($event,dt1)" [(selection)]="selectedItems"
      [paginator]="showPaginator" [rows]="paginatorRows" [columns]="selectedColumns" responsiveLayout="scroll"
      [rowHover]="true" [resizableColumns]="true" [customSort]="true" (onSort)="customSort($event)" dataKey="id">
      <ng-container *ngIf="showCaption">
        <ng-template pTemplate="caption">
          <div class="caption d-flex justify-content-between align-items-center flex-wrap gap-3">
            <!-- <div class="d-flex align-items-center gap-3 dropdown-arrow">
            <p-dropdown #dropdown [options]="rowsPerPageOptions" (onChange)="paginatorOption($event)"
              (onHide)="hide()"></p-dropdown>
          </div> -->
            <ng-container *ngIf="showSearch">
              <span class="p-input-icon-right">
                <span class="p-input-icon-left ml-auto">
                  <i class="pi pi-search"></i>
                  <input pInputText class="search-input" type="text" #search
                    (keyup.enter)="searchHandlerEmit(search?.value)" placeholder="{{'placeholder.search'|translate}}" />
                </span>
                <ng-container *ngIf="search.value && !isLoadingSearch">
                  <i (click)="clearSearchValue(search)" class="pi pi-times text-danger cursor-pointer"></i>
                </ng-container>
                <ng-container *ngIf="isLoadingSearch">
                  <i class="pi pi-spin pi-spinner"></i>
                </ng-container>
              </span>
            </ng-container>

            <div class="d-flex align-items-center gap-3">

              <ng-container *ngIf="enableArticleNoteStatusButton">
                <div class="dropdown">
                  <button data-bs-toggle="dropdown" aria-expanded="false" pButton
                    class="p-button-outlined p-button-secondary clear px-2 fw-bold">
                    <i class="pi pi-arrow-right-arrow-left"></i>
                    <span class="lh-0 ps-1">
                      {{'general.changeStatus'|translate}}
                    </span>
                  </button>
                  <ul class="dropdown-menu border-0 p-3">
                    <ng-container *ngFor="let item of articleStatusList">
                      <li><a class="dropdown-item d-flex gap-1" (click)="itemChangeStatusActionEmitter(item)">
                          {{item?.name}}
                        </a>
                      </li>
                    </ng-container>

                  </ul>
                </div>
              </ng-container>
              <ng-container *ngIf="enableAssignToButton">
                <div class="dropdown" (clickOutside)="collapseAssignMenu == true ? collapseAssignMenu = false :''">
                  <button [attr.aria-expanded]="!collapseAssignMenu" (click)="collapseAssignMenu = !collapseAssignMenu;"
                    pButton class="p-button-outlined p-button-secondary clear px-2 fw-bold">
                    <i class="pi pi-arrow-right scaleX-rtl"></i>
                    <span class="lh-0 ps-1">
                      {{'labels.assignTo'|translate}}
                    </span>
                  </button>
                  <ul class="dropdown-menu border-0 pt-0" [class.show]="collapseAssignMenu">
                    <div class="assignUserMenuSearch">
                      <span class="p-input-icon-right w-100 p-3 ">
                        <span class="p-input-icon-left ml-auto w-100">
                          <i class="pi pi-search"></i>
                          <input pInputText class="search-input" type="text" #search
                            (keyup)="filterUsers(search?.value)" placeholder="{{'placeholder.searchUser'|translate}}" />
                        </span>
                        <ng-container *ngIf="search.value">
                          <i (click)="clearSearchUserValue(search);collapseAssignMenu=true"
                            class="pi pi-times text-danger cursor-pointer mx-3"></i>
                        </ng-container>
                      </span>
                      <hr class="m-0">
                    </div>
                    <div class="p-3 assignUserMenu">
                      <ng-container *ngFor="let item of newAssignedUsers">
                        <li><a class="dropdown-item d-flex gap-1" (click)="itemAssignUserActionEmitter(item)">
                            {{item?.name}}
                          </a>
                        </li>
                      </ng-container>

                    </div>
                  </ul>
                </div>
              </ng-container>



              <ng-container *ngIf="enableAddNewQuestion">
                <div class="dropdown">
                  <button data-bs-toggle="dropdown" aria-expanded="false" pButton
                    label="{{'dashboard.usersList.addNewQuestion'|translate}}"
                    class="p-button-outlined p-button-secondary clear">
                  </button>
                  <ul class="dropdown-menu border-0 p-3">
                    <ng-container *ngFor="let item of newQuestionList">
                      <li><a class="dropdown-item d-flex gap-1">
                          {{item?.name}}
                        </a>
                      </li>
                    </ng-container>

                  </ul>
                </div>
              </ng-container>
              <ng-container *ngIf="enableDeleteButton">
                <button (click)="deleteSelectedItems()" [disabled]="!selectedItems || !selectedItems?.length"
                  class="btn btn-danger clear">{{'general.delete'|translate}}</button>
              </ng-container>
              <div class="d-flex flex-wrap align-items-center gap-3">
                <ng-container *ngIf="showClear">
                  <button pButton label="
                  {{'general.reset'|translate}}" class="p-button-outlined p-button-secondary clear"
                    icon="pi pi-refresh" (click)="clear(dt1)">
                  </button>
                </ng-container>
                <div class="d-flex align-items-center gap-3 dropdown-arrow">
                  <p-dropdown #dropdown [options]="rowsPerPageOptions" (onChange)="paginatorOption($event)"
                    (onHide)="hide()"></p-dropdown>
                </div>
                <!-- <p-multiSelect #colVisible [(ngModel)]="selectedColumns" [options]="tableHeaders" optionLabel="header"
                appendTo="body" selectedItemsLabel="{0} columns selected" [style]="{'min-width': '200px'}"
                placeholder="Choose Columns" pTooltip="Column Visibility" tooltipPosition="top"></p-multiSelect>
              <a pTooltip="print" tooltipPosition="top">
                <img src="assets/images/icons/print.svg" class="action-btn" alt="">
              </a>
              <a pTooltip="XLS" tooltipPosition="top">
                <img src="assets/images/icons/xls.svg" class="action-btn" alt="">
              </a>
              <a pTooltip="PDF" tooltipPosition="top">
                <img src="assets/images/icons/pdf.svg" class="action-btn" alt="">
              </a> -->
              </div>

            </div>
          </div>
        </ng-template>
      </ng-container>
      <ng-template pTemplate="header" let-columns>
        <tr>
          <ng-container *ngIf="showSelection">
            <th>
              <!-- <p-checkbox [(ngModel)]="selectAll" [binary]="true" (onChange)="changeSelectedAll($event)"></p-checkbox>
              <ng-container> -->
              <p-tableHeaderCheckbox (click)="selectionHandlerEmit()"></p-tableHeaderCheckbox>
              <!-- </ng-container> -->
            </th>
          </ng-container>

          <ng-container *ngIf="showArrangement">
            <th>{{'general.arrangement'|translate}}</th>
          </ng-container>

          <ng-container *ngIf="rowExpand">
            <th style="width: 2rem;"></th>
          </ng-container>
          <ng-container *ngIf="showImage">
            <th></th>
          </ng-container>
          <ng-container *ngFor="let col of columns">
            <ng-container *ngIf="col?.sort || col?.filter  ||col?.filterTime ||col?.filterTimes; else elseWithoutSort">
              <ng-container
                *ngIf="col?.type=='text' ||col?.type== 'filterArray' || col?.type=='numeric' || col?.type=='date' || col?.type=='status' || col?.type=='boolean'|| col?.type=='time'">
                <th>
                  <div class="d-flex justify-content-between align-items-center">
                    <span class="d-flex gap-1">
                      <ng-container *ngIf="col?.sort">
                        <div>
                          <ng-container *ngIf="col?.showDefaultSort">
                            <a (click)="toggleSort('asc',col)"><i class="sort pi pi-sort-alt"></i></a>
                          </ng-container>
                          <ng-container *ngIf="col?.showAscSort">
                            <a class="sort" (click)="toggleSort('des',col)"><i class="pi pi-sort-amount-up"></i></a>
                          </ng-container>
                          <ng-container *ngIf="col?.showDesSort">
                            <a class="sort" (click)="toggleSort('asc',col)"><i class="pi pi-sort-amount-down"></i></a>
                          </ng-container>
                        </div>
                      </ng-container>
                      <span> {{ col?.header }}</span>
                    </span>
                    <ng-container *ngIf="col?.filter">
                      <ng-container *ngIf="col?.type!='status' && col?.type!= 'filterArray'">
                        <ng-container *ngIf="col?.type!='time'">
                          <p-columnFilter type="{{col?.type}}" field="{{col?.field}}" display="menu" [showMenu]="true"
                            [showAddButton]="false">
                          </p-columnFilter>
                        </ng-container>
                      </ng-container>
                      <ng-container *ngIf="col?.type== 'filterArray'">
                        <p-columnFilter field="{{col?.field}}" matchMode="in" display="menu" [showMatchModes]="false"
                          [showOperator]="false" [showAddButton]="false">
                          <ng-template pTemplate="header">
                            <div class="px-3 pt-3 pb-0">
                              <span class="font-bold">{{col?.label}}</span>
                            </div>
                          </ng-template>
                          <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                            <p-multiSelect [ngModel]="value"
                              [options]="col?.list=='banks'?banksList:col?.list=='groups'?groupsList:col?.list=='roles'?rolesList:col?.list=='products'?productsList:col?.list=='sections'?sectionsList:col?.list=='examStatus'?examStatusList:col?.list=='parentSkills'?parentSkillsList:col?.list=='questionTypes'?questionTypesList:col?.list=='contentArticlesNotesTypes'?contentArticlesNotesTypes:col?.list=='articlesNotesTypes'?articlesNotesTypes:col?.list=='assignUsers'?assignedUsers:col?.list=='articlesStatus'?articleStatusList:col?.list=='requestSource'?requestSourceList:''"
                              placeholder="{{col?.placeholder}}" (onChange)="filter($event.value)" optionLabel="name">
                              <ng-template let-option pTemplate="item">
                                <div class="p-multiselect-representative-option">
                                  <span class="ml-1">{{option.name}}</span>
                                </div>
                              </ng-template>
                            </p-multiSelect>
                          </ng-template>
                        </p-columnFilter>
                      </ng-container>

                      <ng-container *ngIf="col?.type=='status'">
                        <p-columnFilter field="status" matchMode="equals" display="menu" [showAddButton]="false">
                          <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                            <p-dropdown [ngModel]="value" [options]="statuses" (onChange)="filter($event.value)"
                              placeholder="Any">
                              <ng-template let-option pTemplate="item">
                                <span [class]="'item-badge status-' + option.value">{{option.label}}</span>
                              </ng-template>
                            </p-dropdown>
                          </ng-template>
                        </p-columnFilter>
                      </ng-container>
                    </ng-container>

                    <ng-container *ngIf="col?.filterTime">
                      <ng-container *ngIf="col?.type=='time'">
                        <div class="dropdown">
                          <a class="dropdown-toggle w-100" type="button" aria-expanded="false"
                            [attr.aria-expanded]="!collapse" (click)="collapse = !collapse;collapseEnd=false">
                            <i class="pi pi-filter mx-2"></i>
                          </a>
                          <ul class="dropdown-menu filter p-4 w-100 border-0 mt-2" [class.show]="collapse">
                            <div>
                              <div class="mb-4">
                                <p-dropdown [options]="timeList" (onChange)="collapse=true" optionLabel="name"
                                  [filter]="true" [virtualScroll]="true" [(ngModel)]="operator"
                                  [virtualScrollItemSize]="38" filterBy="name" scrollHeight="200px"
                                  emptyMessage="{{'general.no_result_found'|translate}}" [showClear]="false"
                                  placeholder="{{'placeholder.time'|translate}}" appendTo="body">
                                </p-dropdown>
                              </div>
                              <div class="mb-4">
                                <p-calendar appendTo="body" [(ngModel)]="timeValue" [showIcon]="true" inputId="icon"
                                  [timeOnly]="true" hourFormat="12" placeholder="{{'placeholder.time'| translate}}"
                                  [showButtonBar]="true"></p-calendar>
                              </div>
                              <div class="d-flex justify-content-between gap-2">
                                <button (click)="applyTime(col?.field)" class=" btn
                                  btn-solid-main">{{'primeng.apply'|translate}}</button>
                                <button (click)="clearTime()"
                                  class="btn btn-outline-main">{{'primeng.clear'|translate}}</button>
                              </div>
                            </div>
                          </ul>
                        </div>
                      </ng-container>
                    </ng-container>

                    <ng-container *ngIf="col?.filterTimes">
                      <ng-container *ngIf="col?.type=='time'">
                        <div class="dropdown">
                          <a class="dropdown-toggle w-100" type="button" aria-expanded="false"
                            [attr.aria-expanded]="!collapseEnd" (click)="collapseEnd = !collapseEnd;collapse=false">
                            <i class="pi pi-filter mx-2"></i>
                          </a>
                          <ul class="dropdown-menu filter p-4 w-100 border-0 mt-2" [class.show]="collapseEnd">
                            <div>
                              <div class="mb-4">
                                <p-dropdown [options]="timeList" (onChange)="collapse=true" optionLabel="name"
                                  [filter]="true" [virtualScroll]="true" [(ngModel)]="operatorEnd"
                                  [virtualScrollItemSize]="38" filterBy="name" scrollHeight="200px"
                                  emptyMessage="{{'general.no_result_found'|translate}}" [showClear]="false"
                                  placeholder="{{'placeholder.time'|translate}}" appendTo="body">
                                </p-dropdown>
                              </div>
                              <div class="mb-4">
                                <p-calendar appendTo="body" [(ngModel)]="timeValueEnd" [showIcon]="true" inputId="icon"
                                  [timeOnly]="true" hourFormat="12" placeholder="{{'placeholder.time'| translate}}"
                                  [showButtonBar]="true"></p-calendar>
                              </div>
                              <div class="d-flex justify-content-between gap-2">
                                <button (click)="applyTime(col?.field,'end')" class=" btn
                                  btn-solid-main">{{'primeng.apply'|translate}}</button>
                                <button (click)="clearTime()"
                                  class="btn btn-outline-main">{{'primeng.clear'|translate}}</button>
                              </div>
                            </div>
                          </ul>
                        </div>
                      </ng-container>
                    </ng-container>
                  </div>
                </th>
              </ng-container>
            </ng-container>
            <ng-template #elseWithoutSort>
              <th>
                {{ col?.header }}
              </th>
            </ng-template>
          </ng-container>

          <ng-container *ngIf="showActions">
            <th style="width: 2rem;"></th>
            <!-- <th>{{"dashboard.tableHeader.actions"|translate}}</th> -->
          </ng-container>
          <ng-container *ngIf="showReport">
            <th>{{"dashboard.tableHeader.report"|translate}}</th>
          </ng-container>
          <ng-container *ngIf="showCopy">
            <th>ID</th>
          </ng-container>

        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-item let-columns="columns" let-expanded="expanded">
        <ng-container *ngIf="tableData?.length>0">
          <tr>
            <ng-container *ngIf="showSelection">
              <!-- colspan -->
              <td>
                <ng-container *ngIf="showDefaultSelect">
                  <p-tableCheckbox [value]="item" (click)="selectionHandlerEmit()"></p-tableCheckbox>
                </ng-container>

                <ng-container *ngIf="!showDefaultSelect">
                  <p-checkbox [(ngModel)]="item.checked" [binary]="true"
                    (onChange)="changeSelected($event,item)"></p-checkbox>
                </ng-container>

              </td>
            </ng-container>

            <ng-container *ngIf="showArrangement">
              <td>
                <a (click)="arrangeItems(item)">
                  <i class="pi pi-sort"></i>
                </a>
              </td>
            </ng-container>
            <ng-container *ngIf="rowExpand">
              <ng-container *ngIf="item[itemExpandKey]?.length>0; else noExpand">
                <td>
                  <button type="button" pButton pRipple [pRowToggler]="item"
                    class="p-button-text p-button-rounded p-button-plain row-toggle"
                    [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button>
                </td>
              </ng-container>
              <ng-template #noExpand>
                <td></td>
              </ng-template>
            </ng-container>
            <ng-container *ngIf="showImage">
              <td>
                <img [src]="item?.image" onerror="src='assets/images/not-found/noUser.jpg'" alt="image"
                  class="image rounded-circle">
              </td>
            </ng-container>
            <ng-container *ngFor="let col of columns">
              <ng-container *ngIf="col?.dataType=='array'; else noChild">
                <td>
                  <ng-container *ngIf="item && item[col.field]">
                    <span class="d-flex gap-2">
                      <ng-container *ngFor="let child of item[col.field];let i=index">
                        <ng-container *ngIf="i<2">
                          <span class="child">{{ child[arrayChildKey] }} </span>
                        </ng-container>
                      </ng-container>
                      <ng-container *ngIf="item[col.field]?.length>2">
                        <span class="child"> +{{item[col.field]?.length - 2}}</span>
                      </ng-container>
                    </span>
                  </ng-container>
                  <ng-container *ngIf="item[col.field]?.length==0">
                    <p class="text-center noItemAdded">
                      {{'general.noItemAdded'|translate}}
                    </p>
                  </ng-container>
                </td>
              </ng-container>
              <ng-template #noChild>
                <ng-container *ngIf="(col?.type=='text' || col?.type=='numeric')">
                  <ng-container *ngIf="col?.enabelColEvent; else elseNoColEvent">
                    <td>
                      <a (click)="colEventHandlerEmit(item,col?.typeViewModal)" pTooltip="{{col?.colToolTip}}"
                        tooltipPosition="top">
                        <span [class.truncate-text]="col?.type=='text'" *ngIf="item && item[col.field]">
                          {{ item[col.field] }}
                        </span>
                      </a>
                    </td>
                  </ng-container>
                  <ng-template #elseNoColEvent>
                    <td>
                      <ng-container *ngIf="col?.enableItemLink; else normalRecord">
                        <a (click)="itemActionEmitter(item)" class="text-decoration-underline link-color">
                          <span [class.truncate-text]="col?.type=='text'" *ngIf="item && item[col.field]">
                            {{ item[col.field] }}
                          </span>
                        </a>
                      </ng-container>
                      <ng-template #normalRecord>
                        <span [class.truncate-text]="col?.type=='text'" *ngIf="item && item[col.field]">
                          <div class="d-flex gap-3 align-items-center">
                            <ng-container *ngIf="col?.showImg">
                              <img [src]="item?.image" onerror="src='assets/images/not-found/noUser.jpg'" alt="image"
                                class="image rounded-circle">
                            </ng-container>

                            {{ item[col.field] }}
                          </div>
                        </span>
                      </ng-template>
                    </td>
                  </ng-template>
                </ng-container>
                <ng-container *ngIf="col?.type=='date'">
                  <ng-container *ngIf="enableDateFormate; else initialFormate">
                    <td>
                      {{item[col?.field] | date:dateFormateString}}
                    </td>
                  </ng-container>
                  <ng-template #initialFormate>
                    <td>
                      {{item[col?.field] | date: 'dd/MM/YYYY'}}
                    </td>
                  </ng-template>
                </ng-container>
                <ng-container *ngIf="col?.type=='status'">
                  <td>
                    <span [class]="'item-badge status-' + item?.status">{{item?.status}}</span>
                  </td>
                </ng-container>
                <ng-container *ngIf="col?.type=='boolean'">
                  <td>
                    <p-inputSwitch [(ngModel)]="item.is_active" (onChange)="statusHandlerEmit(item)"
                      pTooltip="{{'general.changeStatus'|translate}}" tooltipPosition="top">
                    </p-inputSwitch>
                  </td>
                </ng-container>
                <ng-container *ngIf="col?.type=='time'">
                  <td>
                    {{item[col?.field]}}
                  </td>
                </ng-container>
              </ng-template>
            </ng-container>
            <ng-container *ngIf="showActions">
              <td>
                <ng-container *ngIf="showActionInMenu; else notMenu">
                  <div class="dropdown">
                    <a class="dropdown-toggle text-main-color px-4" type="button" data-bs-toggle="dropdown"
                      aria-expanded="false">
                      <i class="fas fa-ellipsis-vertical"></i>
                    </a>
                    <ul class="dropdown-menu global-card p-3 border-0 actionInMenu">
                      <ng-container *ngIf="showDetails">
                        <a class="d-flex align-items-center
                        gap-2" (click)="detailsHandlerEmit(item)">
                          <i class="far fa-eye"></i>
                          <span>{{'general.view'|translate}}</span>
                        </a>
                      </ng-container>
                      <ng-container *ngIf="showEdit">
                        <a class="d-flex align-items-center
                          gap-2" (click)="editHandlerEmit(item)">
                          <span><i class="fas fa-pen"></i></span>
                          <span>{{'general.edit'|translate}}</span>
                        </a>
                      </ng-container>
                      <ng-container *ngIf="showCopyAction">
                        <a class="d-flex align-items-center
                          gap-2" (click)="copyActionHandlerEmit(item)" pTooltip="{{'general.copy'|translate}}"
                          tooltipPosition="top">
                          <span><i class="fas fa-copy"></i></span>
                        </a>
                      </ng-container>
                      <ng-container *ngIf="showDelete">
                        <a class="d-flex align-items-center
                          gap-2" (click)="deleteHandlerEmit(item)">
                          <span><i class="fas fa-trash-alt"></i></span>
                          <span>{{'general.delete'|translate}}</span>
                        </a>
                      </ng-container>
                      <ng-container *ngIf="showResetPassword">
                        <a class="d-flex align-items-center
                                gap-2" (click)="resetPasswordHandlerEmit(item)">
                          <span><i class="pi pi-unlock fs-5-1"></i></span>
                          <span>{{'general.resetPassword'|translate}}</span>
                        </a>
                      </ng-container>

                      <ng-container *ngIf="showPermissions">
                        <a class="d-flex align-items-center
                                gap-2" (click)="permissionsHandlerEmit(item)">
                          <span><i class="pi pi-key fs-5-1"></i></span>
                          <span>{{'general.permissions'|translate}}</span>
                        </a>
                      </ng-container>

                      <ng-container *ngIf="showLockAccount">
                        <ng-container *ngIf="item?.isLockAccount; else elseTemplate">
                          <a class="d-flex align-items-center
                                  gap-2" (click)="lockAccountHandlerEmit(item)">
                            <span><i class="pi pi-unlock fs-5-1"></i></span>
                            <span>{{'general.unLockAccount'|translate}}</span>
                          </a>
                        </ng-container>
                        <ng-template #elseTemplate>
                          <a class="d-flex align-items-center
                                  gap-2" (click)="unLockAccountHandlerEmit(item)">
                            <span><i class="pi pi-lock fs-5-1"></i></span>
                            <span>{{'general.lockAccount'|translate}}</span>
                          </a>
                        </ng-template>

                      </ng-container>
                    </ul>
                  </div>
                </ng-container>
                <ng-template #notMenu>
                  <div class="d-flex gap-2">
                    <ng-container *ngIf="showDetails">
                      <a class="fw-500 details" (click)="detailsHandlerEmit(item)"
                        pTooltip="{{'general.details'|translate}}" tooltipPosition="top">
                        <i class="far fa-eye"></i>
                      </a>
                    </ng-container>
                    <ng-container *ngIf="showEdit">
                      <a class="d-flex align-items-center
                        gap-2" (click)="editHandlerEmit(item)" pTooltip="{{'general.edit'|translate}}"
                        tooltipPosition="top">
                        <span><i class="fas fa-pen edit"></i></span>
                      </a>
                    </ng-container>
                    <ng-container *ngIf="showCopyAction">
                      <a class="d-flex align-items-center
                        gap-2" (click)="copyActionHandlerEmit(item)" pTooltip="{{'general.copy'|translate}}"
                        tooltipPosition="top">
                        <span><i class="fas fa-copy"></i></span>
                      </a>
                    </ng-container>
                    <ng-container *ngIf="showDelete">
                      <a class="d-flex align-items-center
                        gap-2" (click)="deleteHandlerEmit(item)" pTooltip="{{'general.delete'|translate}}"
                        tooltipPosition="top">
                        <span><i class="fas fa-trash-alt remove"></i></span>
                      </a>
                    </ng-container>
                    <ng-container *ngIf="showResetPassword">
                      <a class="d-flex align-items-center
                              gap-2" (click)="resetPasswordHandlerEmit(item)"
                        pTooltip="{{'form.resetPassword'|translate}}" tooltipPosition="top">
                        <span><i class="pi pi-unlock
                          reset-password fs-5-1"></i></span>
                      </a>
                    </ng-container>
                  </div>
                </ng-template>
              </td>
            </ng-container>
            <ng-container *ngIf="showReport">
              <td>
                <div class="d-flex gap-2">
                  <a class="fw-500" (click)="reportHandlerEmit(item)" pTooltip="{{'general.report'|translate}}"
                    tooltipPosition="top">
                    <i class="pi pi-download fs-5-1"></i>
                  </a>
                </div>
              </td>
            </ng-container>
            <ng-container *ngIf="showCopy">
              <td>
                <div class="d-flex gap-2">
                  <a class="fw-500" (click)="copyHandlerEmit(item)">
                    <i class="pi pi-copy"></i>
                  </a>
                </div>
              </td>
            </ng-container>
          </tr>
        </ng-container>

      </ng-template>
      <ng-template pTemplate="rowexpansion" let-item>
        <tr>
          <td class="p-0" [attr.colspan]="tableHeaders.length+3">
            <div>
              <p-table [value]="item[itemExpandKey]" dataKey="id" id="childTable" [columns]="tableHeaders"
                responsiveLayout="scroll" [rowHover]="false" [resizableColumns]="true" [customSort]="true"
                (onSort)="customSort($event)">
                <ng-template pTemplate="header" let-columns>
                  <ng-container *ngIf="showChildHeader">
        <tr>
          <ng-container *ngIf="showSelection">
            <th>
              <!-- <p-checkbox [(ngModel)]="selectAll" [binary]="true"></p-checkbox>

              <ng-container> -->
              <p-tableHeaderCheckbox (click)="selectionHandlerEmit()"></p-tableHeaderCheckbox>
              <!-- </ng-container> -->

            </th>
          </ng-container>

          <th></th>
          <th></th>

          <ng-container *ngFor="let col of columns">
            <ng-container *ngIf="col?.sort || col?.filter; else elseWithoutSort">
              <ng-container
                *ngIf="col?.type=='text' ||col?.type== 'filterArray' || col?.type=='numeric' || col?.type=='date' || col?.type=='status' || col?.type=='boolean'">
                <th pSortableColumn="{{col.field}}">
                  <div class="d-flex justify-content-between align-items-center">
                    <span>
                      <ng-container *ngIf="col?.sort">
                        <p-sortIcon field="{{col?.field}}"></p-sortIcon>
                      </ng-container>
                      <span> {{ col?.header }}</span>
                    </span>
                    <ng-container *ngIf="col?.filter">
                      <ng-container *ngIf="col?.type!='status' && col?.type!= 'filterArray'">
                        <p-columnFilter type="{{col?.type}}" field="{{col?.field}}" display="menu" [showMenu]="true"
                          [showAddButton]="false">
                        </p-columnFilter>
                      </ng-container>

                      <ng-container *ngIf="col?.type== 'filterArray'">
                        <p-columnFilter field="{{col?.field}}" matchMode="in" display="menu" [showMatchModes]="false"
                          [showOperator]="false" [showAddButton]="false">
                          <ng-template pTemplate="header">
                            <div class="px-3 pt-3 pb-0">
                              <span class="font-bold">{{col?.label}}</span>
                            </div>
                          </ng-template>
                          <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                            <p-multiSelect [ngModel]="value"
                              [options]="col?.list=='banks'?banksList:col?.list=='groups'?groupsList:col?.list=='roles'?rolesList:col?.list=='products'?productsList:col?.list=='sections'?sectionsList:col?.list=='examStatus'?examStatusList:col?.list=='parentSkills'?parentSkillsList:col?.list=='questionTypes'?questionTypesList:col?.list=='contentArticlesNotesTypes'?contentArticlesNotesTypes:col?.list=='articlesNotesTypes'?articlesNotesTypes:col?.list=='assignUsers'?assignedUsers:col?.list=='articlesStatus'?articleStatusList:col?.list=='requestSource'?requestSourceList:''"
                              placeholder="{{col?.placeholder}}" (onChange)="filter($event.value)" optionLabel="name">
                              <ng-template let-option pTemplate="item">
                                <div class="p-multiselect-representative-option">
                                  <span class="ml-1">{{option.name}}</span>
                                </div>
                              </ng-template>
                            </p-multiSelect>
                          </ng-template>
                        </p-columnFilter>
                      </ng-container>

                      <ng-container *ngIf="col?.type=='status'">
                        <p-columnFilter field="status" matchMode="equals" display="menu" [showAddButton]="false">
                          <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                            <p-dropdown [ngModel]="value" [options]="statuses" (onChange)="filter($event.value)"
                              placeholder="Any">
                              <ng-template let-option pTemplate="item">
                                <span [class]="'item-badge status-' + option.value">{{option.label}}</span>
                              </ng-template>
                            </p-dropdown>
                          </ng-template>
                        </p-columnFilter>
                      </ng-container>
                    </ng-container>
                  </div>
                </th>
              </ng-container>

            </ng-container>
            <ng-template #elseWithoutSort>
              <th>
                {{ col?.header }}
              </th>
            </ng-template>
          </ng-container>

          <ng-container *ngIf="showActions">
            <th>{{"dashboard.tableHeader.actions"|translate}}</th>
          </ng-container>
          <ng-container *ngIf="showReport">
            <th>{{"dashboard.tableHeader.report"|translate}}</th>
          </ng-container>
          <ng-container *ngIf="showCopy">
            <th>ID</th>
          </ng-container>

        </tr>
        </ng-container>

      </ng-template>
      <ng-template pTemplate="body" let-item let-columns="columns">
        <ng-container *ngIf="tableData?.length>0">
          <tr>
            <ng-container *ngIf="showSelection">
              <td>
                <ng-container *ngIf="!showDefaultSelect">
                  <p-checkbox [(ngModel)]="item.checked" [binary]="true"></p-checkbox>
                </ng-container>

                <ng-container *ngIf="showDefaultSelect">
                  <p-tableCheckbox [value]="item" (click)="selectionHandlerEmit()"></p-tableCheckbox>
                </ng-container>
              </td>
            </ng-container>
            <td></td>
            <td></td>
            <!-- <ng-container *ngIf="showArrangement">
              <td>
                <a (click)="arrangeItems(item)">
                  <i class="pi pi-sort"></i>
                </a>
              </td>
            </ng-container>
            <ng-container *ngIf="rowExpand">
              <ng-container *ngIf="true; else noExpand">
                <td>
                  <button type="button" pButton pRipple [pRowToggler]="item"
                    class="p-button-text p-button-rounded p-button-plain row-toggle"
                    [icon]="'pi pi-chevron-right'"></button>
                </td>
              </ng-container>
              <ng-template #noExpand>
                <td></td>
              </ng-template>
            </ng-container> -->
            <ng-container *ngFor="let col of columns">
              <ng-container *ngIf="col?.dataType=='array'; else noChild">
                <td>
                  <ng-container *ngIf="item && item[col.field]">
                    <span class="d-flex gap-2">
                      <ng-container *ngFor="let child of item[col.field];let i=index">
                        <ng-container *ngIf="i<2">
                          <span class="child">{{ child[arrayChildKey] }} </span>
                        </ng-container>

                      </ng-container>
                      <ng-container *ngIf="item[col.field]?.length>2">
                        <span class="child"> +{{item[col.field]?.length - 2}}</span>
                      </ng-container>
                    </span>
                  </ng-container>
                  <ng-container *ngIf="item[col.field]?.length==0">
                    <p class="text-center noItemAdded">
                      {{'general.noItemAdded'|translate}}
                    </p>
                  </ng-container>
                </td>
              </ng-container>
              <ng-template #noChild>
                <ng-container *ngIf="(col?.type=='text' || col?.type=='numeric')">
                  <ng-container *ngIf="col?.enabelColEvent; else elseNoColEvent">
                    <td>
                      <a (click)="colEventHandlerEmit(item,col?.typeViewModal)" pTooltip="{{col?.colToolTip}}"
                        tooltipPosition="top">
                        <span [class.truncate-text]="col?.type=='text'" *ngIf="item && item[col.field]">
                          {{ item[col.field] }}
                        </span>
                      </a>
                    </td>
                  </ng-container>
                  <ng-template #elseNoColEvent>
                    <td>
                      <span [class.truncate-text]="col?.type=='text'" *ngIf="item && item[col.field]">
                        {{ item[col.field] }}
                      </span>
                    </td>
                  </ng-template>
                </ng-container>
                <ng-container *ngIf="col?.type=='date'">
                  <ng-container *ngIf="enableDateFormate; else initialFormate">
                    <td>
                      {{item[col?.field] | date: dateFormateString}}
                    </td>
                  </ng-container>
                  <ng-template #initialFormate>
                    <td>
                      {{item[col?.field] | date: 'dd/MM/YYYY'}}
                    </td>
                  </ng-template>
                </ng-container>
                <ng-container *ngIf="col?.type=='status'">
                  <td>
                    <span [class]="'item-badge status-' + item?.status">{{item?.status}}</span>
                  </td>
                </ng-container>
                <ng-container *ngIf="col?.type=='boolean'">
                  <td>
                    <p-inputSwitch [(ngModel)]="item.is_active" (onChange)="statusHandlerEmit(item)"
                      pTooltip="{{'general.changeStatus'|translate}}" tooltipPosition="top">
                    </p-inputSwitch>
                  </td>
                </ng-container>
              </ng-template>
            </ng-container>
            <ng-container *ngIf="showActions">
              <td>
                <div class="dropdown">
                  <a class="dropdown-toggle d-flex align-items-center gap-2 text-muted-color" type="button"
                    id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                    {{'general.monthly'|translate}}
                  </a>
                  <ul class="dropdown-menu border-0 shadow-sm mt-3 p-2" aria-labelledby="dropdownMenuButton1">
                    <ng-container *ngIf="showDetails">
                      <li>
                        <a class="fw-500 details" pTooltip="{{'general.details'|translate}}" tooltipPosition="top"
                          (click)="detailsHandlerEmit(item)">
                          <i class="far fa-eye"></i>
                        </a>
                      </li>
                    </ng-container>

                    <ng-container *ngIf="showEdit">
                      <li>
                        <a class="d-flex align-items-center
                        gap-2" (click)="editChildHandlerEmit(item)" pTooltip="{{'general.edit'|translate}}"
                          tooltipPosition="top">
                          <span><i class="fas fa-pen edit"></i></span>
                        </a>
                      </li>
                    </ng-container>
                    <ng-container *ngIf="showDelete">
                      <li>
                        <a class="d-flex align-items-center
                        gap-2" (click)="deleteHandlerEmit(item)" pTooltip="{{'general.delete'|translate}}"
                          tooltipPosition="top">
                          <span><i class="fas fa-trash-alt remove"></i></span>
                        </a>
                      </li>
                    </ng-container>
                  </ul>
                </div>
                <!-- <div class="d-flex gap-2">
                  <ng-container *ngIf="showDetails">
                    <a class="fw-500 details" pTooltip="{{'general.details'|translate}}" tooltipPosition="top"
                      (click)="detailsHandlerEmit(item)">
                      <i class="far fa-eye"></i>
                    </a>
                  </ng-container>

                  <ng-container *ngIf="showEdit">
                    <a class="d-flex align-items-center
                      gap-2" (click)="editChildHandlerEmit(item)" pTooltip="{{'general.edit'|translate}}"
                      tooltipPosition="top">
                      <span><i class="fas fa-pen edit"></i></span>
                    </a>
                  </ng-container>
                  <ng-container *ngIf="showCopyAction">
                    <a class="d-flex align-items-center
                      gap-2" (click)="copyChildHandlerEmit(item)" pTooltip="{{'general.copy'|translate}}"
                      tooltipPosition="top">
                      <span><i class="fas fa-copy"></i></span>
                    </a>
                  </ng-container>
                  <ng-container *ngIf="showDelete">
                    <a class="d-flex align-items-center
                      gap-2" (click)="deleteHandlerEmit(item)" pTooltip="{{'general.delete'|translate}}"
                      tooltipPosition="top">
                      <span><i class="fas fa-trash-alt remove"></i></span>
                    </a>
                  </ng-container>
                  <ng-container *ngIf="showResetPassword">
                    <a class="d-flex align-items-center
                            gap-2" (click)="resetPasswordHandlerEmit(item)"
                      pTooltip="{{'form.resetPassword'|translate}}" tooltipPosition="top">
                      <span><i class="pi pi-unlock
                        reset-password fs-5-1"></i></span>
                    </a>
                  </ng-container>
                </div> -->
              </td>
            </ng-container>
            <ng-container *ngIf="showReport">
              <td>
                <div class="d-flex gap-2">
                  <a class="fw-500" (click)="reportHandlerEmit(item)" pTooltip="{{'general.report'|translate}}"
                    tooltipPosition="top">
                    <i class="pi pi-download fs-5-1"></i>
                  </a>
                </div>
              </td>
            </ng-container>
            <ng-container *ngIf="showCopy">
              <td>
                <div class="d-flex gap-2">
                  <a class="fw-500" (click)="copyHandlerEmit(item)">
                    <i class="pi pi-copy"></i>
                  </a>
                </div>
              </td>
            </ng-container>
          </tr>
        </ng-container>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="6">There are no order for this product yet.</td>
        </tr>
      </ng-template>
    </p-table>
  </div>
  </td>
  </tr>
  </ng-template>
  <ng-template pTemplate="emptymessage">
    <ng-container *ngIf="!isLoading">
      <tr>
        <td [attr.colspan]="tableHeaders.length+1">
          <div class="not-found d-flex flex-column justify-content-center align-items-center">
            <ng-container *ngIf="!isSearch">
              <img [src]="notFoundImage" onerror="this.src='assets/images/not-found/no-data.svg'"
                class="mb-3 notFound-img" alt="notFound">
              <p class="fw-500">{{notFoundText}}</p>
            </ng-container>
            <ng-container *ngIf="isSearch">
              <img [src]="notFoundImage" onerror="this.src='assets/images/not-found/no-data.svg'" class="mb-3"
                alt="notFound">
              <p class="fw-500">{{"general.no_search_result"|translate}}</p>
            </ng-container>
          </div>
        </td>
      </tr>
    </ng-container>
    <ng-container *ngIf="isLoading && !isSearch">
      <tr>
        <td class="p-0" [attr.colspan]="showReport?tableHeaders?.length+2:tableHeaders?.length+1">
          <!-- <app-skeleton [type]="'table'" [tableItems]="skeletonItems"></app-skeleton> -->
        </td>
      </tr>
    </ng-container>

  </ng-template>
  </p-table>
</div>
<!-- <ng-container *ngIf="tableData?.length>0">
  <div class="d-flex justify-content-center my-3">
    <ng-container *ngIf="showPaginationText">
      <p>Showing {{pageNumber}} to {{pages}} of {{results}} results</p>
    </ng-container>
    <p-paginator #paginator [rows]="paginatorRows" [totalRecords]="results" [showPageLinks]="true" [pageLinkSize]="3"
      (onPageChange)="paginate($event)"></p-paginator>

  </div>
</ng-container> -->
</div>